!function(){"use strict";function t(t,e){console.time(t);const n=e();return console.timeEnd(t),n}class e{constructor(){this.trie={}}get(t){let e=this.trie;for(const n of t)if(e=e[n],void 0===e)return null;return e.$||null}set(t,e){let n=this.trie;const r=t.length-1;for(const[s,o]of function*(t){let e=0;for(const n of t)yield[e,n],e++}(t))n[o]?s===r&&n[o].$?n[o].$.push(e(t,o,s)):s===r&&(n[o].$=[e(t,o,s)]):n[o]=s===r?{$:[e(t,o,s)]}:{},n=n[o];return this}has(t){return!!this.get(t)}words(){const t=function*(e,n){for(const r of Object.keys(e))"$"===r?yield n.join(""):yield*t(e[r],[...n,r])};return t(this.trie,[])}}const n={letter:/[a-zA-Z]/i,number:/\d/i,space:/\s/i,punct:/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,\-.\/:;<=>?@\[\]^_`{|}~]/i};function r(t){return n.letter.test(t)}function s(t){return n.space.test(t)}function o(t){return n.punct.test(t)}function i(t){return n.number.test(t)}class u{constructor(t){this.input=t,this.pos=0}next(){return this.input.charAt(this.pos++)}peek(){return this.input.charAt(this.pos)}eof(){return""===this.peek()}err(t){throw new Error(`${t} @ ${this.pos}`)}}class c{constructor(t){this.current=null,this.input=t}readWhile(t){let e="";for(;!this.input.eof()&&t(this.input.peek());)e+=this.input.next();return e}readNum(){let t=!1,e=this.readWhile((e=>"."===e?!t&&(t=!0,!0):i(e)));return{type:"number",value:parseFloat(e)}}readWord(){return{type:"word",value:this.readWhile(r)}}readSpace(){return{type:"space",value:this.readWhile(s)}}readPunct(){return{type:"punctuation",value:this.readWhile(o)}}readUnknown(){return{type:"unknown",value:this.input.next()}}peek(){return this.current||(this.current=this.readNext())}next(){let t=this.current;return this.current=null,t||this.readNext()}eof(){return null===this.peek()}readNext(){if(this.input.eof())return null;{const t=this.input.peek();return r(t)?this.readWord():i(t)?this.readNum():s(t)?this.readSpace():o(t)?this.readPunct():this.readUnknown()}}}function l(t){let e=new Map;for(const{value:n}of t)e.has(n)?e.set(n,e.get(n)+1):e.set(n,1);const n=e.size;let r=[];for(const[t,s]of e)r.push({term:t,count:s,termFrequency:s/n});return r}function a(t,e){return t.getElementsByClassName(e)}function d([t]){return t}function h(t,e){return t.appendChild(e),t}function f(t){return document.createElement(t)}function p({score:t,elem:e}){const n=`${(100*t).toFixed(2)}%`,r=h(f("div"),(s=f("h3"),void 0===(o=`Relevance: ${n}`)?s.textContent:(s.textContent=o,s)));var s,o;return h(r,e)}function m(t){return function(t){const e=new c(new u(t));let n=[];for(;!e.eof();)n.push(e.next());return n}(t).filter((({type:t})=>"word"===t))}$Postings=null;var y=[];!function(t,e){const n=d(a(document,"comment-tree")),r=Array.from(a(n,"athing")).map(((t,e)=>function(t,e,n){const r=e.querySelector(".commtext").textContent.toLowerCase();return{_id:n,elem:e,text:r,score:0}}(0,t,e))).tee((({text:t},n)=>e.push(t)));$Postings=function(t){let e=[...t],n={filter(r){const s=r.reduce(((t,{_id:e,...n})=>(t[e]=n,t)),{});return e=t.filter((({_id:t})=>!!s[t])).map((t=>({...t,score:s[t._id].tf_idf}))).sort(((t,e)=>e.score-t.score)),n},reset:()=>(e=[...t],n),appendElements(){const t=d(a(document,"comment-tree")),n=function(t,e){for(const n of e)h(t,n);return t}(f("table"),e.map(p));return h(((r=t).innerHTML="",r),n);var r}};return n}(r)}(0,y),ENGINE=null,t("[init engine]",(()=>ENGINE=function(n){const r=n.length,s=t("[tokenize]",(()=>n.map(m)));let o=new e;return t("[build trie]",(()=>{for(const[t,e]of enumerate(s))for(const n of l(e)){const{term:e,termFrequency:r}=n;o.set(e,(()=>({_id:t,termFrequency:r})))}})),{totalDocs:r,trie:o,search(t){return t.split(" ").reduce(((t,e)=>(t.push(...this.tf_idf(e)),t)),[]).sort(((t,e)=>e.tf_idf-t.tf_idf))},tf_idf(t){const e=o.get(t)||[],n=e.length,s=Math.log(r/n);let i=[];for(let t=0;t<n;t++){const{_id:n,termFrequency:r}=e[t];i.push({_id:n,tf:r,idf:s,tf_idf:r*s})}return i}}}(y))),searchListener=function(){let t=new Map,e={subscribe:(n,r)=>(t.set(n,r),e),unsubscribe:n=>(t.delete(n),e),notify(n){for(const[e,r]of t)r(n);return e}};return e}();var b=document.querySelector(".fatitem tbody");b.appendChild(function(){const e=document.createElement("tr");return e.innerHTML='\n\t\t<td colspan="2"></td>\n\t\t<td>\n\t\t\t<label>Search Job Postings</label>\n\t\t\t<input type="text" id="job-search-bar" />\n\t\t</td>\n\t',e.querySelector("#job-search-bar").onchange=function(e){const n=t("[search]",(()=>ENGINE.search(this.value)));searchListener.notify(n)},e}()),b.appendChild(function(){const t=document.createElement("tr");t.innerHTML='\n\t\t<td colspan="2"></td>\n\t\t<td><div id="job-search-results"></div></td>\n\t';const e=t.querySelector("#job-search-results");return searchListener.subscribe("SearchResults",(t=>{const n=t.length;e.textContent=`${n} documents found.`,0===n?$Postings.reset().appendElements():$Postings.filter(t).appendElements()})),t}())}();
